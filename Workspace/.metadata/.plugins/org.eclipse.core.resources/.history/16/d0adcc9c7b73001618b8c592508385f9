from pipeline import *
from lingpy.basic.wordlist import * 
from lingpy import LexStat

def writeToFile():
    print("LOAD TEST WORDLIST")
    pathToAnnotatedWordList = "Data/IELex/output/IELex-2016.tsv"
    
    languages,words,global_ids,cognate_classes = loadAnnotatedWordList(pathToAnnotatedWordList, {730})
    with f as codecs.open("lexstat_wordlist.txt","wb"):
        f.write("CONCEPT\tIPA\tDOCULECT\tCOGID\n")
        
    wl =get_wordlist("Data/IELex/output/IELex-2016.tsv",delimiter="\t",row="gloss",col="language")
    print(wl.get_dict(concept="tree",entry="IPA"))
    print("initializing lexstat")
    lex = LexStat(wl)
    print("getting scorer")
    lex.get_scorer()
    print("clustering")
    lex.cluster(method="lexstat", threshold=0.6, ref="cognate_class_pred")
    print("output")
    lex.output('tsv', filename="lexstat_ielex")
    
    from lingpy.evaluate.acd import bcubes, diff
    bcubes(lex, "cognate_class", "cognate_class_pred")
    print(bcubes(lex, "cognate_class", "cognate_class_pred"))

